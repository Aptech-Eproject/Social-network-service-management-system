services:
  # ============================================
  # üö™ API GATEWAY - Production
  # ============================================
  api-gateway:
    image: ${DOCKER_REGISTRY}/snms-api-gateway:latest
    container_name: snms-gateway-prod
    ports:
      - "8000:8000"
    env_file:
      - ../../backend/api-gateway/.env.production
    environment:
      ASPNETCORE_ENVIRONMENT: Production
      ASPNETCORE_URLS: http://+:8000
    depends_on:
      - user-service
      - social-service
    networks:
      - snms-network
    restart: always
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M

  # ============================================
  # üë§ USER SERVICE - Production
  # ============================================
  user-service:
    image: ${DOCKER_REGISTRY}/snms-user-service:latest
    container_name: snms-user-prod
    expose:
      - "8081"
    env_file:
      - ../../backend/user-service/.env.production
    environment:
      ASPNETCORE_ENVIRONMENT: Production
      ASPNETCORE_URLS: http://+:8081
    networks:
      - snms-network
    restart: always
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M

  # ============================================
  # üåê SOCIAL SERVICE - Production
  # ============================================
  social-service:
    image: ${DOCKER_REGISTRY}/snms-social-service:latest
    container_name: snms-social-prod
    expose:
      - "8082"
    env_file:
      - ../../backend/social-service/.env.production
    environment:
      ASPNETCORE_ENVIRONMENT: Production
      ASPNETCORE_URLS: http://+:8082
    networks:
      - snms-network
    restart: always
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 512M
        reservations:
          cpus: '0.5'
          memory: 256M

networks:
  snms-network:
    driver: bridge
    name: snms-prod-network